import numpy as np
import matplotlib.pyplot as plt
plt.rcParams["font.sans-serif"] = ["SimHei"]  # 设置字体中文乱码问题
plt.rcParams["axes.unicode_minus"] = False  # 该语句解决图像中的“-”负号的乱码问题
y_AIT504 = [1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1235452,1235452,1235452,1235068,1234299,1234299,1234299,1234299,1234299,1234299,1233914,1233145,1233145,1233145,1233145,1233145,1233145,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1231607,1231607,1231607,1231607,1231607,1231607,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233914,1235837,1235837,1235837,1231992,1231992,1231992,1231992,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1231223,1231223,1231223,1231223,1234299,1235452,1235452,1235452,1235452,1234299,1232376,1232376,1232376,1232376,1232376,1232376,1232376,1232376,1232376,1232376,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1235452,1235452,1235452,1235452,1235452,1235452,1235452,1231223,1231223,1234299,1234299,1234299,1234299,1234299,1234299,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233145,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1233914,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1234299,1235068,1238144,1238144,1238144,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1235068,1288131,1288131,1288131,1207383,1188157,1188157,1188157,1188157,1130479,1095873,1095873,1095873,1076647,1042041,1015124,9920533,9920533,9920533,9920533,9459113,9459113,9459113,9459113,8882338,8882338,8882338,8882338,8882338,8882338,8574724,8574724,8574724,8574724,8113304,8113304,8113304,8113304,8113304,8113304,8113304,8113304,8113304,7844142,7844142,7844142,7844142,7844142,7844142,7844142,7844142,7344271,7344271,7613432,7613432,7613432,7613432,7613432,7613432,7613432,7613432,7613432,7613432,7613432,7613432,7613432,7613432,7498077,7421174,7421174,7421174,7421174,7421174,7421174,7421174,7421174,7421174,7613432,7613432,7613432,7613432,7536529,7421174,7421174,7421174,7421174,7421174,7421174,7459626,7613432,7690336,7690336,7690336,7690336,7690336,7690336,7690336,7690336,7690336,7690336,7690336,7690336,7690336,7690336,7690336,7690336,7690336,7690336,7690336,7728787,7921046,7921046,7921046,7536529,7536529,7536529,7921046,7921046,7921046,7921046,7921046,7921046,7921046,7921046,7921046,7921046,7921046,7921046,7921046,7921046,7921046,7921046,7921046,7921046,7921046,7921046,7997949,7997949,7997949,7997949,7997949,7997949,7997949,7997949,7997949,7997949,7997949,7997949,7997949,7997949,7997949,7997949,7997949,7997949,8305563,8305563,8305563,8113304,8113304,8113304,8113304,8113304,8113304,8113304,8113304,8497821,8497821,8497821,8497821,7882594,7882594,8574724,8574724,8574724,8267111,8267111,8267111,8267111,8420918,8420918,8420918,8420918,8420918,8574724,8574724,8574724,8574724,8574724,8574724,8574724,8574724,8574724,8574724,8574724,8574724,8574724,8574724,8574724,8574724,8574724,8574724,8574724,8574724,8805434,8805434,8805434,8805434,8805434,8805434,8805434,8805434,8805434,8651628,8651628,8651628,8843886,8843886,8843886,8843886,8843886,8843886,8843886,8651628,8651628,8651628,8651628,8843886,8843886,8843886,8843886,8843886,8843886,8843886,8843886,8843886,8882338,8882338,8805434,8805434,8805434,8805434,8805434,8805434,8805434,9266854,9266854,8997693,8997693,8997693,8997693,8997693,8997693,8997693,8997693,8997693,8997693,8997693,8997693,8997693,8997693,8997693,8997693,8997693,8997693,8997693,9266854,9266854,9266854,9266854,8882338,8882338,9189951,9189951,9189951,9189951,9189951,9189951,9189951,9189951,9189951,9189951,9189951,9189951,9189951,9189951,9189951,9189951,9189951,9266854,9266854,9266854,9266854,9266854,9266854,9266854,9266854,9266854,9266854,9266854,9266854,9266854,9266854,9266854,9266854,9266854,9266854,9420661,9420661,9420661,9420661,9420661,9420661,9420661,9420661,9420661,9420661,9420661,9420661,9420661,9420661,9420661,9420661,9420661,9420661,9420661,9420661,9420661,9420661,9420661,9651371,9651371,9536016,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9459113,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9728274,9958985,9958985,9958985,9766726,9766726,9766726,9766726,9766726,9766726,9766726,9766726,9766726,9766726,9766726,9766726,9766726,9766726,9766726,9766726,9766726,9766726,9766726,9958985,9958985,9958985,9958985,9958985,9958985,9805178,9805178,9805178,9805178,9805178,9805178,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,9997437,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1015124,1038195,1042041,1042041,1042041,1042041,1042041,1030505,1042041,1049731,1049731,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1030505,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1022815,1022815,1022815,1053576,1053576,1053576,1053576,1022815,1022815,1022815,1022815,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1038195,1068957,1068957,1061266,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1053576,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1049731,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1088183,1088183,1088183,1088183,1068957,1049731,1049731,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1057421,1080492,1080492,1080492,1080492,1080492,1080492,1053576,1053576,1053576,1053576,1053576,1072802,1072802,1072802,1072802,1072802,1072802,1057421,1057421,1057421,1068957,1092028,1092028,1092028,1092028,1092028,1092028,1092028,1061266,1061266,1061266,1061266,1061266,1080492,1080492,1080492,1080492,1080492,1080492,1080492,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1088183,1088183,1088183,1088183,1088183,1088183,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1061266,1088183,1088183,1088183,1088183,1088183,1053576,1053576,1053576,1107408,1107408,1092028,1092028,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1076647,1088183,1092028,1092028,1092028,1092028,1092028,1092028,1092028,1092028,1092028,1092028,1092028,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183,1088183]

x = np.arange(1, len(y_AIT504)+1)
if __name__ == '__main__':
    y = np.copy(y_AIT504)
    y = y / 10000000
    # 进行离散傅里叶变换
    fft_result = np.fft.fft(y)
    amplitude = np.abs(fft_result) #幅度
    phase = np.angle(fft_result) #相位
    #添加噪声
    noise = np.random.normal(loc=np.mean(amplitude), scale=np.sqrt(np.var(amplitude)), size=len(fft_result))
    a1 = np.copy(amplitude)
    a1[100] = noise[100]
    a2 = np.copy(amplitude)
    a2[100:105] = noise[100:105]
    a3 = np.copy(amplitude)
    a3[100:120] = noise[100:120]
    a4 = np.copy(amplitude)
    a4[100:150] = noise[100:150]
    #phase[:100] = noise_phase[:100]
    #构建复数数组
    complex_array1 = a1 * np.exp(1j * phase)
    complex_array2 = a2 * np.exp(1j * phase)
    complex_array3 = a3 * np.exp(1j * phase)
    complex_array4 = a4 * np.exp(1j * phase)

    # 绘制原始信号、逆变换结果和频谱图
    plt.figure(figsize=(8, 6))

    plt.subplot(4, 1, 1)
    plt.plot(x, np.real(np.fft.ifft(complex_array1)), 'r', label='生成数据')  # 使用np.real提取实部
    plt.plot(x, y, label='原始数据')
    plt.title('扰动1个点')
    plt.xlabel('点索引')
    plt.ylabel('数值')
    plt.ylim(0,1)
    plt.legend(fontsize='7')

    plt.subplot(4, 1, 2)
    plt.plot(x, np.real(np.fft.ifft(complex_array2)), 'r', label='生成数据')  # 使用np.real提取实部
    plt.plot(x, y, label='原始数据')
    plt.title('扰动5个点')
    plt.xlabel('点索引')
    plt.ylabel('数值')
    plt.ylim(0, 1)
    plt.legend(fontsize='7')

    plt.subplot(4, 1, 3)
    plt.plot(x, np.real(np.fft.ifft(complex_array3)), 'r', label='生成数据')  # 使用np.real提取实部
    plt.plot(x, y, label='原始数据')
    plt.title('扰动10个点')
    plt.xlabel('点索引')
    plt.ylabel('数值')
    plt.ylim(0, 1)
    plt.legend(fontsize='7')

    plt.subplot(4, 1, 4)
    plt.plot(x, np.real(np.fft.ifft(complex_array4)), 'r', label='生成数据')  # 使用np.real提取实部
    plt.plot(x, y, label='原始数据')
    plt.title('扰动20个点')
    plt.xlabel('点索引')
    plt.ylabel('数值')
    plt.ylim(0, 1)
    plt.legend(fontsize='7')


    plt.tight_layout()
    plt.show()